entryPoints:
  web:
    address: ":80"

routers:
  mobile-redirect:
    rule: "PathPrefix(`/validate-drivers-mail`) || PathPrefix(`/change-email-initiate`) || PathPrefix(`/forgot-password`) || PathPrefix(`/change-email`)"
    entryPoints:
      - web
    middlewares:
      - mobile-redirect

middlewares:
  mobile-redirect:
    plugin:
      deep_linking:
        # Additional configuration options can be added here if needed
        # For example, you could specify logging options or other settings
        # that are relevant to the mobile redirect functionality.

displayName: Traefik Deep Linking
type: middleware
iconPath: .assets/icon.png

import: github.com/traefik/plugindemo

summary: '
  This plugin is a Traefik middleware that redirects mobile users to a specific URL.
  It checks the user agent and if it matches a mobile device, it redirects to the specified URL.
  Otherwise, it allows the request to continue to the original destination.'

testData:
  apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: mobile-deep-link-redirect
  namespace: superego
spec:
  plugin:
    mobile-redirect:
      redirects:
        /validate-email: "app://validate-email"
        /change-email: "app://change-email"
        /forgot-password: "app://forgot-password"
        /change-email: "app://change-email"